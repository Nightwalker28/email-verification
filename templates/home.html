{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}
<div class="verification-section">
    <!-- Display attempts remaining if any -->
    {% if attempts is not none %}
    <p>You have {{ attempts }} verification attempts left.</p>
    {% endif %}

    <h2>Email Verification</h2>
    <form id="manualEmailForm">
        <div class="form-group">
            <label for="emailAddress">Enter Email Address</label><br>
            <input type="email" id="emailAddress" name="emailAddress" required>
        </div>
        <button type="submit" class="btn">Verify Email</button>
    </form>

    <!-- Last Checked Email Section -->
    {% if show_recent_result and last_checked_emails %}
    <h3>Most Recent Email Verification Result:</h3>
    <table class="table">
        <thead>
            <tr>
                <th>Email</th>
                <th>Result</th>
                <th>Provider</th>
                <th>Role Based</th>
                <th>Accept All</th>
                <th>Full Inbox</th>
                <th>Temporary Mail</th>
            </tr>
        </thead>
        <tbody>
            {% for email_record in last_checked_emails %}
            <tr>
                <td>{{ email_record.email }}</td>
                <td>{{ email_record.result }}</td>
                <td>{{ email_record.provider }}</td>
                <td>{{ 'Yes' if email_record.role_based else 'No' }}</td>
                <td>{{ 'Yes' if email_record.accept_all else 'No' }}</td>
                <td>{{ 'Yes' if email_record.full_inbox else 'No' }}</td>
                <td>{{ 'Yes' if email_record.disposable else 'No' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
</div>

<div class="summary-section">
    <h2>Your Summary</h2>
    <div class="summary-card">
        <div class="list-summary">
            <h3>Summary of Uploaded Lists</h3>
            <p>Total Lists: {{ list_summary.total_lists }}</p>
            <p>Total Emails Checked: {{ list_summary.total_emails_checked }}</p>
            <p>Total Verified: {{ list_summary.total_verified }}</p>
            <p>Total Risky: {{ list_summary.total_risky }}</p>
            <p>Total Invalid: {{ list_summary.total_invalid }}</p>
            <p>Total Unknown: {{ list_summary.total_unknown }}</p>
        </div>
        <div class="recent-summary">
            <h3>Summary of Recent Verifications (Last 30 Days)</h3>
            {% if recent_summary %}
            <p>Total Emails Checked: {{ recent_summary.total_recent_emails_checked }}</p>
            <p>Recent Verified: {{ recent_summary.recent_verified }}</p>
            <p>Recent Invalid: {{ recent_summary.recent_invalid }}</p>
            <p>Recent Risky: {{ recent_summary.recent_risky }}</p>
            <p>Recent Unknown: {{ recent_summary.recent_unknown }}</p>
            {% else %}
            <p>No recent email verifications in the last 30 days.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
